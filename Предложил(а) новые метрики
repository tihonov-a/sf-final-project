Дополнительное задание
Помимо тех метрик, которые ребята запросили, вам нужно немного «покопаться» в данных и предложить 3 дополнительные метрики, которые на ваш взгляд будут им полезны в решении этой задачи.

При в расчете rolling retention с разбивкой по когортам, мы видим снижение активности до нуля пользователей в некоторые периоды.
Считаю, что необходимо провести мониторинг пользователей по месяцам, это позволит нам выявить явные периоды для запуска релизов на платформе.
Максимальное количество новых пользователей приходится на февраль 1058, при этом максимальный спад на май - октябрь включительно (1-13 человек).

select
    to_char(date_joined, 'MM') as month,
    count(*) as registrations
from users u
group by month
order by month

_____________________________________________________________________________________________________________________________________________________________________________________________

Дополнительно предложу выявить наиболее проблемные задачи и отнести их в платный контент с подробным разьяснением.

select problem_id,
	round(sum(case when is_false = 0 then 1 else 0 end)::numeric / count(*), 2) as problem_solved
	from codesubmit c
	group by problem_id
	order by problem_solved desc
	
_____________________________________________________________________________________________________________________________________________________________________________________________

Думаю, не будет лишним промониторить входящий трафик относительно зарегистрировавшихся пользователей.
Это поможет нам определить процент потерянных пользователей, для дальнейшего выявления причин и проведения меропиятий для охвата нужного нам процента.
Мне кажется, что в нашем случае результат отличный, охвачено 85% входящего трафика, но все зависит от поставленных целей компании.

with users_d as(
	select 
		count(distinct u.user_id) as user_entry,
		count(distinct u2.id) as user_registered
	from userentry u 
	left join users u2 
	on u.user_id = u2.id)
select
	round((user_registered::numeric/ user_entry * 100), 2) as users_diff
from users_d


Итоговые выводы по смене модели монетизации.

Я считаю, что вам нужно предложить пользователям 3 варанта подписки: 
	неделя - для закрытия краткосрочных потребностей пользователей платформы; 
	месяц - для отработки знаний и преобретения навыков; 
	безлимит - для полного, детального погружения.
При расчете стоимости подписки ориентироваться на медианный баланс и расход пользователя, т.к имеем огромный разрыв среднего и медианного балансов.
Для повышения заинтересованности пользователя в безлимитной подписке, нужно сделать макимально возможную скидку 30% и выше. 
В платную подписку включить наиболее популярный контент и контент вызывающий затруднения с подробным разбором заданий. 
Ввести ограничение на колиство бесплатного решения тестов и задач, разбор решений в день (например: 2шт).
Ввести общее ограничение на количество бесплатных тестов и задач за весь период пользования платформой (например: 30 задач и тестов раскрывающие основные темы). 
Подсказки можно оставить в бесплатном доступе, для поддержания заинтересованности и проявления лояльности пользователей.
Также рекомендую пересмотреть ценовую политику вознаграждений за активность на платформе в меньшую сторону, ввиду несопоставимых средних значений начислений и трат пользователей. 
Проводить маркетинговые акции в период максимальношго спада спроса пользователей май - октябрь.
